<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
    <link rel="icon" href="./Resources/logo.png">
    <title>UTC's Testbed</title>
    <script src="./Libraries/jquery-3.1.1.js"></script>
    <script src="./Libraries/semantic/out/semantic.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/tippy.js@3/dist/tippy.all.min.js"></script>
    <script src="scal.js"></script>
    <link rel="stylesheet" type="text/css" href="./Libraries/semantic/out/semantic.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.1/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="scal.css">
</head>

<body onload="init()">
    <div class="pusher">
        <div class="ui inverted vertical masthead center aligned segment">
            <div class="ui text container">
                <!-- <img src="./Resources/logo.png" class="ui centered rounded image" style="width: 24em; height: auto;"> -->
                <h1 id="header_text">Chattanooga's MLK Boulevard Testbed</h1>
                <h2 id="header_subtext">Demos of the software currently implemented</h2>
            </div>
        </div>

        <div class="ui vertical stripe segment">

            <!-- Header -->
            <h2 id="counter" class="section_header">
                <i class="ui linkify icon" id="counter_icon" onclick="copyURL('http://utc-scal-testbed.com#counter', this)"></i>
                Vehicle and Pedestrian Counting using YOLO
            </h2>

            <!-- Stream Read Error Section: Shown by default -->
            <div id="counting_feed_err">
                <center>
                    <div class="ui huge steps">
                        <div class="step">
                            <i class="large icons">
                                <i class="red video icon"></i>
                            </i>Video Feed is Currently Offline
                        </div>
                    </div>
                </center>
            </div>

            <div style="max-width: 1280px; max-height: 720px; width: 80%; margin: auto;">
                <div class="ui button" onclick="hideVideo(this)">Hide Live Stream</div>
            </div>



            <div style="max-width: 1280px; max-height: 720px; width: 80%; margin: auto;" id="video_feed">
                <!-- TODO: Eventually have toggle switches above the iFrame to change src of feed between cams -->
                <iframe src="http://150.182.130.194:3030/video_feed" frameborder="0" class="counter" scrolling="no"></iframe>
            </div>

            <script>
                // Check to see if it can hit the video feed:
                    $.ajax({url: "http://150.182.130.194:3030/video_feed",
                                type: "HEAD",
                                timeout:1000,
                                statusCode: {
                                    200: function (response) {
                                        $('#counting_feed_err').hide()
                                    },
                                    400: function (response) {
                                        $('#video_feed').hide()
                                    },
                                    0: function (response) {
                                        $('#counting_feed_err').hide()
                                    }              
                                }
                        });
                </script>



            <!-- The information beneath the panel -->
            <div class="info_panel">
                <h2><i class="info icon"></i>More Information:</h2>
                <p>
                    This is done using <a href="https://pjreddie.com/darknet/yolo/" target="_blank">YOLO (You Only
                        Look Once)</a>, a Convolutional Neural Network (CNN) that has been trained to detect a variety
                    of different objects. This project in particular uses
                    <a href="https://pjreddie.com/darknet/yolov2/" target="_blank">YOLO v2</a>, which can detect 80
                    different kinds of objects!<br> This project also uses
                    <a href="https://www.pyimagesearch.com/2018/07/23/simple-object-tracking-with-opencv/" target="_blank">PyImageSearch's
                        Object Tracking</a>. Originally it utilized a Caffe model, but that was found to be quite
                    inefficient and required much lower quality footage (thus reducing accuracy as well). Instead of
                    suffering in quality and accuracy, the team decided to utilize YOLO's accurate detection with
                    PyImageSearch's accurate tracking. The result is shown above (unless the processing server is
                    offline).
                </p>
            </div>
        </div>
    </div>
    <input type="text" value="http://utc-scal-testbed.com" id="copyText" style="display:none;">

</body>

</html>